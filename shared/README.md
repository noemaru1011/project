# 共通定義（Shared）

## 概要

フロントエンドとバックエンドで共有する定数、型定義、Zodスキーマを管理しています。

## ディレクトリ構成
```
shared/
├── constants/
│   └── # apiMessage.ts: フロント・バック共通で使用する成功/失敗時のシステムメッセージ定義
│
├── models/
│   ├── auth/
│   │   ├── schemas.ts       # ログイン・パスワード変更のZodバリデーション定義
│   │   ├── types.ts         #ログイン時のレスポンスを定義(トークン・ロール・パスワード変更推奨フラグ)
│   │   ├── schemas.test.ts  # バリデーションルールの妥当性を検証するテスト
│   │   └── index.ts         # authドメインの型/スキーマを外部から呼び出しやすくする窓口
│   │
│   ├── history/
│   │   ├── schemas.ts       # 履歴画面用Zodスキーマ
│   │   ├── types.ts         # 履歴データのDTO型、レスポンス型など
│   │   ├── schemas.test.ts  # 入力値チェックの境界値テスト
│   │   └── index.ts         # 履歴ドメインの外部公開設定
│   │
│   ├── student/
│   │   ├── schemas.ts       # 学生画面用Zodスキーマ
│   │   ├── types.ts         # 学生エンティティ・データのDTO型、レスポンス型など
│   │   ├── schemas.test.ts  # 名前の文字数や形式のテスト
│   │   └── index.ts         # 学生ドメインの外部公開設定
│   │
│   ├── common/
│   │   ├── types.ts         # APIレスポンスやロールの共通型など
│   │   └── index.ts         # 共通型の外部公開設定
│   │
│   └── master/
│       ├── types.ts         # マスタデータ用型定義(DTO)
│       └── index.ts         # マスタデータの外部公開設定
│
└─── routes/
    └── # routes.ts: バックエンドのパス定義。axiosのベースURLやエンドポイントを管理
```

### constants/

APIレスポンスメッセージを定義
```
#一部抜粋
export const APIMESSAGE = {
  FETCH_SUCCESS: "取得成功。",
  CREATE_SUCCESS: "追加完了。",
  UPDATE_SUCCESS: "更新完了。",
  DELETE_SUCCESS: "削除完了。",
  LOGIN_SUCCESS: "ログインが成功しました。",
  LOGOUT_SUCCESS: "ログアウトしました。",
};
```

### models/

#### 型定義

フロントエンド・バックエンド両方で使用する共通の型定義

#### Zodスキーマ

**フロントエンド用スキーマ:**

- UI入力を前提とした最低限のバリデーション
- 基本的に文字列型
- 必須チェック、文字数制限など

**バックエンド用スキーマ:**

- DB型に合わせた型変換
- より厳密なバリデーション
- FK違反、重複制約違反などのDB単位のエラーはServiceレイヤーで処理

## 単体テスト戦略

### テストパターン

すべての単体テストは AAAパターン（Arrange, Act, Assert）に従って記述

### 単体テスト対象

| 対象 | 理由 |
| ---- | ----|
| フロントエンド用Zodスキーマ | UI入力バリデーションの動作保証 |

### 単体テスト対象外

| 対象 | 対象外とする理由 |
| ----- | ---------------|
| バックエンド用Zodスキーマ | 型変換のみで、Zodライブラリ側でテスト済み |
| 型定義 | TypeScriptのコンパイラがチェック |
| constants | 定数定義のみ |
| routes | URL文字列の定義のみ |

### 注意事項

- フロント・バック両方で使う型は必ず shared/models/ に定義
- スキーマ変更時は、フロント・バック両方への影響を確認

